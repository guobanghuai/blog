<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PixiJS | blog</title>
    <meta name="description" content="blog from Qi">
    <link rel="icon" href="/blog/images/favicon.png">
  <meta name="theme-color" content="#00adb5">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#00adb5">
  <meta name="description" itemprop="description" content="blog from Qi">
  <meta itemprop="name" content="js_trick">
  <meta itemprop="image" content="/js_tricks/images/favicon.png">
    
    <link rel="preload" href="/blog/assets/css/0.styles.8be14f65.css" as="style"><link rel="preload" href="/blog/assets/js/app.f9bcb806.js" as="script"><link rel="preload" href="/blog/assets/js/26.fd941958.js" as="script"><link rel="preload" href="/blog/assets/js/2.e9cd7337.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.17c0b57d.js"><link rel="prefetch" href="/blog/assets/js/11.9aadbfba.js"><link rel="prefetch" href="/blog/assets/js/12.69153d9c.js"><link rel="prefetch" href="/blog/assets/js/13.0a44e59a.js"><link rel="prefetch" href="/blog/assets/js/14.f32d415a.js"><link rel="prefetch" href="/blog/assets/js/15.692b6d9a.js"><link rel="prefetch" href="/blog/assets/js/16.35dbae08.js"><link rel="prefetch" href="/blog/assets/js/17.af0711c0.js"><link rel="prefetch" href="/blog/assets/js/18.08f59d7f.js"><link rel="prefetch" href="/blog/assets/js/19.96b788c7.js"><link rel="prefetch" href="/blog/assets/js/20.b04b7c9c.js"><link rel="prefetch" href="/blog/assets/js/21.744660d2.js"><link rel="prefetch" href="/blog/assets/js/22.d4882bd4.js"><link rel="prefetch" href="/blog/assets/js/23.2179b4ab.js"><link rel="prefetch" href="/blog/assets/js/24.ed55aa76.js"><link rel="prefetch" href="/blog/assets/js/25.dac15c80.js"><link rel="prefetch" href="/blog/assets/js/27.42bd57da.js"><link rel="prefetch" href="/blog/assets/js/28.3dc86a52.js"><link rel="prefetch" href="/blog/assets/js/29.84516804.js"><link rel="prefetch" href="/blog/assets/js/3.59364ffe.js"><link rel="prefetch" href="/blog/assets/js/4.606673b8.js"><link rel="prefetch" href="/blog/assets/js/5.a644421f.js"><link rel="prefetch" href="/blog/assets/js/6.7062016e.js"><link rel="prefetch" href="/blog/assets/js/7.6f3d948d.js"><link rel="prefetch" href="/blog/assets/js/8.aedad399.js"><link rel="prefetch" href="/blog/assets/js/9.366b0920.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.8be14f65.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>实现</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>basic</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>leetcode</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>其他</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/blog/other/性能优化.html" class="sidebar-link">性能优化</a></li><li><a href="/blog/other/gulp.html" class="sidebar-link">gulp相关</a></li><li><a href="/blog/other/pixi.html" class="active sidebar-link">PixiJS</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="pixijs">PixiJS</h1> <h3 id="一-pixijs-介绍">一. PixiJS 介绍</h3> <p><a href="http://pixijs.download/release/docs/index.html">PixiJS</a>是一个轻量级的2D渲染引擎，它能自动侦测使用WebGL还是Canvas来创建图形。开发者无需专门学习 WebGL 就能感受到强大的硬件加速的力量。虽然 PixiJS 非常适合制作小游戏，但它并不是一个游戏引擎。
<a href="https://www.bookstack.cn/read/LearningPixi/introduction">官方教程</a></p> <h3 id="二-核心概念">二. 核心概念</h3> <h4 id="_1-application应用">1. Application应用</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">// 创建一个Pixi 应用</span>
  width<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  height<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  antialias<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  transparent<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  resolution<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment">// 设置成window.devicePixelRatio，避免手机端设备显示模糊</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 把 Pixi 应用中创建出来的 canvas 添加到页面上</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 在离开页面时需要手动清理内存，否则无法释放WebGL内存</span>
app<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_2-container-容器">2. Container 容器</h4> <p>应用的根容器是app.stage。可以用PIXI.Container()方法创建子容器</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> bgContainer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个背景容器</span>
<span class="token keyword">const</span> bgSprite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sprite<span class="token punctuation">.</span>from</span><span class="token punctuation">(</span><span class="token string">'bg.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bgContainer<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>bgSprite<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个图片并添加到容器里</span>
app<span class="token punctuation">.</span>stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>bgContainer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将创建的容器添加到app根容器里</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>可以分别创建多个容器，将不同的单元进行分组。分组之后，可以单独进行管理。</p></div> <p>这里的容器类似html里的dom结构。可以相互嵌套，有“父子子属关系”，有“兄弟并列关系”，有“层级上下关系”。</p> <h5 id="容器操作">容器操作</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 添加子代到容器</span>
<span class="token comment">// 添加一个子代</span>
container<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>sprite<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 也可以添加多个,它们的深度是：先添加的在最下面</span>
container<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>sprite1<span class="token punctuation">,</span>sprite2<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 添加子代到容器的指定位置：</span>
<span class="token comment">// 添加一个子代到指定位置,如果索引超出范围会报错</span>
container<span class="token punctuation">.</span><span class="token function">addChildAt</span><span class="token punctuation">(</span>sprite<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 返回指定位置的子代：</span>
container<span class="token punctuation">.</span><span class="token function">getChildAt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 从容器中取出一个或多个孩子</span>
container<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>sprite<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 从指定的索引位置删除子级</span>
container<span class="token punctuation">.</span><span class="token function">removeChildAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 从此容器中删除在开始索引和结束索引内的所有子项</span>
<span class="token comment">// 移除所有，默认值为开始到结束</span>
container<span class="token punctuation">.</span><span class="token function">removeChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 移除第二个和三个</span>
container<span class="token punctuation">.</span><span class="token function">removeChildren</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_3-renderer-渲染器">3. Renderer 渲染器</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>app<span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>view<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'absolute'</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>view<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>view<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span>renderer<span class="token punctuation">.</span>autoDensity <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 重新设置应用的大小</span>
app<span class="token punctuation">.</span>stage<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> baseWidth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置缩放比，配合resolution可以在不同设备像素比手机上高清显示</span>
</code></pre></div><h4 id="_4-sprite-精灵">4. Sprite 精灵</h4> <p>Sprite精灵是可以放在容器里的交互式图像。精灵是你能用代码控制图像的基础。你能够控制他们的位置，大小，和许多其他有用的属性来产生交互和动画。 创建一个精灵需要用 PIXI.Sprite() 方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> avatar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sprite<span class="token punctuation">.</span>from</span><span class="token punctuation">(</span><span class="token string">'avatar.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 和普通的图形一样可以设置各种属性</span>
avatar<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
avatar<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
avatar<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
avatar<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_5-loader-加载器">5. Loader 加载器</h4> <p>加载图片通常需要耗费一定的时间，因此我们常常使用Loader来预加载图片，当图片全部加载成功后，才开始渲染。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Loader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> resources <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'img1'</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token string">'img1.png'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'img2'</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token string">'img2.png'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'img3'</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token string">'img3.png'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>resources<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span>onProgress<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>loadProgressHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span>onError<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span>onLoad<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span>onComplete<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>setup<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">loadProgressHandler</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> resource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'loading: '</span> <span class="token operator">+</span> resource<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'progress: '</span> <span class="token operator">+</span> loader<span class="token punctuation">.</span>progress <span class="token operator">+</span> <span class="token string">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'All files loaded'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过add方法添加需要加载的图片，所有图片加载完成后，load方法会调用传入的setup回调函数，这时就可以渲染各种元素。onProgress事件可以监听加载的进度，通过这个方法，可以很方便的制作进度条动画。</p> <h4 id="_6-texture-纹理">6. Texture 纹理</h4> <p>因为 Pixi 用 WebGL 和 GPU 去渲染图像，所以图像需要转化成 GPU 可以处理的格式。可以被 GPU 处理的图像被称作纹理 。在你让精灵显示图片之前，需要将普通的图片转化成 WebGL 纹理。为了让所有工作执行的快速有效率，Pixi使用 纹理缓存 来存储和引用所有你的精灵需要的纹理。纹理的名称字符串就是图像的地址。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Loader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> resources <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'img1'</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token string">'img1.png'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'img2'</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token string">'img2.png'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'img3'</span><span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token string">'img3.png'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>resources<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sprite1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sprite</span><span class="token punctuation">(</span>loader<span class="token punctuation">.</span>resources<span class="token punctuation">[</span><span class="token string">'img1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texture<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果图片在缓存里没有，也可以加载一张新的图片</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">PIXI</span><span class="token punctuation">.</span>Texture<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token string">'new.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_7-ticker-帧率更新函数">7. Ticker 帧率更新函数</h4> <p>Ticker有点类似前端的requestAnimationFrame，当浏览器的显示频率刷新的时候，此函数会被执行，因此常常用来制作帧动画。app.ticker就是一个Ticker实例。（经测试4.0版本使用app.ticker在ios端会有问题，可以用requestAnimationFrame替换，5.0尚未测试）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">move</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  sprite<span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sprite<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span>ticker<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>move<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 移除执行函数</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
app<span class="token punctuation">.</span>ticker<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>move<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>用requestAnimationFrame实现</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> raqId<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">move</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  sprite<span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  raqId <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>move<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sprite<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>raqId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_8-graphic-几何图形">8. Graphic 几何图形</h4> <p>graphics主要用于绘制原始形状（如线条，圆形和矩形）以及他们的上色和填充。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> graphics <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Graphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 线框 </span>
graphics<span class="token punctuation">.</span><span class="token function">lineStyle</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x0000FF</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> graphics<span class="token punctuation">.</span><span class="token function">drawRect</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment">// 四边形 </span>
graphics<span class="token punctuation">.</span><span class="token function">drawRect</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment">// 圆形 </span>
graphics<span class="token punctuation">.</span><span class="token function">drawCircle</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token comment">// 椭圆 </span>
graphics<span class="token punctuation">.</span><span class="token function">drawEllipse</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token comment">// 圆角矩形 </span>
graphics<span class="token punctuation">.</span><span class="token function">drawRoundedRect</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">440</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
<span class="token comment">// 星星 </span>
graphics<span class="token punctuation">.</span><span class="token function">drawStar</span><span class="token punctuation">(</span><span class="token number">360</span><span class="token punctuation">,</span> <span class="token number">370</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token comment">// 多边形 </span>
graphics<span class="token punctuation">.</span><span class="token function">drawPolygon</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
<span class="token comment">// 贝塞尔曲线 </span>
graphics<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment">// 圆弧 </span>
graphics<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>graphics<span class="token punctuation">)</span>
</code></pre></div><p>清除图形 用graphics.clear()方法</p> <h4 id="_9-text-文本">9. Text 文本</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 自定义文字样式 </span>
<span class="token keyword">const</span> style <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>TextStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    
  fontFamily<span class="token punctuation">:</span> <span class="token string">'Arial'</span><span class="token punctuation">,</span>    
  fontSize<span class="token punctuation">:</span> <span class="token number">36</span><span class="token punctuation">,</span>    
  fontStyle<span class="token punctuation">:</span> <span class="token string">'italic'</span><span class="token punctuation">,</span>    
  fontWeight<span class="token punctuation">:</span> <span class="token string">'bold'</span><span class="token punctuation">,</span>    
  fill<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'#ffffff'</span><span class="token punctuation">,</span> <span class="token string">'#00ff99'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    
  stroke<span class="token punctuation">:</span> <span class="token string">'#4a1850'</span><span class="token punctuation">,</span>    
  strokeThickness<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>    
  dropShadow<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    
  dropShadowColor<span class="token punctuation">:</span> <span class="token string">'#000000'</span><span class="token punctuation">,</span>    
  dropShadowBlur<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>    
  dropShadowAngle<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">,</span>    
  dropShadowDistance<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>    
  wordWrap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    
  wordWrapWidth<span class="token punctuation">:</span> <span class="token number">440</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Text</span><span class="token punctuation">(</span><span class="token string">'hello word！'</span><span class="token punctuation">,</span> style<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
</code></pre></div><h4 id="_10-事件交互">10. 事件交互</h4> <p>pixi中常用的鼠标交互事件：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 兼容鼠标和触摸屏的共同触发</span>
type InteractionPointerEvents <span class="token operator">=</span> <span class="token string">&quot;pointerdown&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;pointercancel&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;pointerup&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;pointertap&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;pointerupoutside&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;pointermove&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;pointerover&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;pointerout&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 触摸屏触发事件</span>
type InteractionTouchEvents <span class="token operator">=</span> <span class="token string">&quot;touchstart&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;touchcancel&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;touchend&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;touchendoutside&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;touchmove&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;tap&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 鼠标触发事件</span>
type InteractionMouseEvents <span class="token operator">=</span> <span class="token string">&quot;rightdown&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;mousedown&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;rightup&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;mouseup&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;rightclick&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;click&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;rightupoutside&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;mouseupoutside&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;mousemove&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;mouseover&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;mouseout&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>点击事件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Graphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
point<span class="token punctuation">.</span><span class="token function">beginFill</span><span class="token punctuation">(</span><span class="token number">0x0bef47</span><span class="token punctuation">)</span>
point<span class="token punctuation">.</span><span class="token function">drawCircle</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
point<span class="token punctuation">.</span><span class="token function">endFill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
point<span class="token punctuation">.</span>interactive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">// 响应交互</span>
point<span class="token punctuation">.</span>buttonMode <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">// 鼠标变手型</span>
point<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;pointerdown&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">:</span> <span class="token constant">PIXI</span><span class="token punctuation">.</span>InteractionEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;graphics&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>interactive 默认为false，不会响应交互事件。buttonMode属性，默认为false，设置为true时，鼠标悬浮会变成手型。或者可以直接设置cursor来修改光标样式</p></div> <p>拖拽</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> texture <span class="token operator">=</span> <span class="token constant">PIXI</span><span class="token punctuation">.</span>Texture<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token string">'examples/assets/bunny.png'</span><span class="token punctuation">)</span> 
<span class="token keyword">const</span> bunny <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>texture<span class="token punctuation">)</span>
bunny    
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'pointerdown'</span><span class="token punctuation">,</span> onDragStart<span class="token punctuation">)</span>    
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'pointerup'</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span>    
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'pointerupoutside'</span><span class="token punctuation">,</span> onDragEnd<span class="token punctuation">)</span>    
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'pointermove'</span><span class="token punctuation">,</span> onDragMove<span class="token punctuation">)</span>     
<span class="token keyword">function</span> <span class="token function">onDragStart</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    
  <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> event<span class="token punctuation">.</span>data    
  <span class="token keyword">this</span><span class="token punctuation">.</span>alpha <span class="token operator">=</span> <span class="token number">0.5</span>    
  <span class="token keyword">this</span><span class="token punctuation">.</span>dragging <span class="token operator">=</span> <span class="token boolean">true</span> 
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">onDragEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
  <span class="token keyword">this</span><span class="token punctuation">.</span>alpha <span class="token operator">=</span> <span class="token number">1</span>    
  <span class="token keyword">this</span><span class="token punctuation">.</span>dragging <span class="token operator">=</span> <span class="token boolean">false</span>    
  <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">null</span> 
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">onDragMove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dragging<span class="token punctuation">)</span> <span class="token punctuation">{</span>        
    <span class="token keyword">const</span> newPosition <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">getLocalPosition</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>parent<span class="token punctuation">)</span>        
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> newPosition<span class="token punctuation">.</span>x        
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> newPosition<span class="token punctuation">.</span>y    
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre></div><h3 id="三-动画精灵">三. 动画精灵</h3> <p>动画在游戏里是必不可少的，Pixi为我们提供了AnimatedSprite方法加载动画。这里的动画通常是指帧动画，将动画的每一关键帧制作成图片并按顺序加载。通常会把一组动画制作成一张雪碧图。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> base <span class="token operator">=</span> TextureCache<span class="token punctuation">[</span>imgURL<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//第一个纹理</span>
<span class="token keyword">let</span> texture0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Texture</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span>
texture0<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//第二个纹理</span>
<span class="token keyword">let</span> texture1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Texture</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span>
texture1<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//第三个纹理</span>
<span class="token keyword">let</span> texture2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Texture</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span>
texture2<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//第四个纹理</span>
<span class="token keyword">let</span> texture3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Texture</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span>
texture3<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//创建纹理数组</span>
<span class="token keyword">let</span> textures <span class="token operator">=</span> <span class="token punctuation">[</span>texture0<span class="token punctuation">,</span> texture1<span class="token punctuation">,</span> texture2<span class="token punctuation">,</span>texture3<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//创建动画精灵</span>
<span class="token keyword">let</span> pixie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PIXI<span class="token punctuation">.</span>extras<span class="token punctuation">.</span>AnimatedSprite</span><span class="token punctuation">(</span>textures<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//设置动画精灵的速度</span>
pixie<span class="token punctuation">.</span>animationSpeed<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>

<span class="token comment">//把动画精灵添加到舞台</span>
app<span class="token punctuation">.</span>stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>pixie<span class="token punctuation">)</span><span class="token punctuation">;</span>

pixie<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//播放动画精灵</span>
<span class="token comment">// pixie.gotoAndPlay(); //转到特定的帧并开始播放动画精灵</span>
<span class="token comment">// pixie.stop(); //停止播放动画精灵</span>
<span class="token comment">// pixie.gotoAndStop(); //转到特定的帧并停止播放动画精灵</span>

</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>如果觉得这样加载动画很麻烦，推荐使用<a href="https://github.com/kittykatattack/spriteUtilities">SpriteUtilities</a> 的库，该库包含许多有用的函数，用于创建Pixi精灵并使它们更易于使用。</p></div> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/other/gulp.html" class="prev">
          gulp相关
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/blog/assets/js/app.f9bcb806.js" defer></script><script src="/blog/assets/js/26.fd941958.js" defer></script><script src="/blog/assets/js/2.e9cd7337.js" defer></script>
  </body>
</html>
